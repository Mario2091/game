<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Snake + RPS + Tic Tac Toe</title>
<style>
  body {
    background: black;
    color: #fff;
    font-family: Arial, sans-serif;
    text-align: center;
  }
  canvas {
    background: black;
    border: 3px solid #ff00ff;
    display: block;
    margin: 20px auto;
    box-shadow: 0 0 20px #ff00ff;
  }
  h1 {
    color: #ff00ff;
    text-shadow: 0 0 15px #ff00ff, 0 0 25px #00f, 0 0 40px #f00;
  }
  button {
    background: black;
    border: 2px solid #ff00ff;
    color: #ff00ff;
    margin: 5px;
    padding: 10px;
    border-radius: 6px;
    text-shadow: 0 0 10px #ff00ff, 0 0 15px #00f;
    cursor: pointer;
  }
  button:hover {
    background: #ff00ff;
    color: black;
  }
  /* Popups */
  .popup {
    position: fixed;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    background: black;
    padding: 20px;
    border: 3px solid #ff00ff;
    display: none;
    z-index: 1000;
    box-shadow: 0 0 30px #ff00ff, 0 0 40px #00f, 0 0 50px #f00;
  }
  .popup h2 {
    color: #ff00ff;
    margin-bottom: 15px;
  }
  /* Tic Tac Toe */
  #ticTacToeBoard {
    display: grid;
    grid-template-columns: repeat(3, 80px);
    grid-gap: 5px;
    justify-content: center;
  }
  #ticTacToeBoard button {
    width: 80px;
    height: 80px;
    font-size: 32px;
    color: #fff;
    border: 2px solid #ff00ff;
    text-shadow: 0 0 10px #ff00ff, 0 0 15px #00f, 0 0 25px #f00;
  }
</style>
</head>
<body>
<h1>Snake + RPSLS + TicTacToe (Neon Edition)</h1>
<canvas id="snakeCanvas" width="400" height="400"></canvas>
<div id="snakeScore">Score: 0</div>
<button onclick="resetSnake()">Restart Snake</button>

<!-- RPS Popup -->
<div id="rpsPopup" class="popup">
  <h2>Play RPSLS to Continue!</h2>
  <div>
    <button onclick="playRPS('rock')">‚úä</button>
    <button onclick="playRPS('paper')">‚úã</button>
    <button onclick="playRPS('scissors')">‚úåÔ∏è</button>
    <button onclick="playRPS('lizard')">ü¶é</button>
    <button onclick="playRPS('spock')">üññ</button>
  </div>
  <div id="rpsResult"></div>
</div>

<!-- Tic Tac Toe Popup -->
<div id="tttPopup" class="popup">
  <h2>Win Tic Tac Toe!</h2>
  <div id="ticTacToeBoard"></div>
  <div id="tttResult"></div>
</div>

<script>
/* ---------------- Snake ---------------- */
const canvas = document.getElementById("snakeCanvas");
const ctx = canvas.getContext("2d");
const box = 20;

let snake, food, direction, score, snakeInterval;
let pausedForMiniGame = false;

function resetSnake() {
  snake = [{x: 5*box, y: 5*box}];
  direction = "RIGHT";
  score = 0;
  createFood();
  clearInterval(snakeInterval);
  snakeInterval = setInterval(game, 150);
}
function createFood() {
  food = {
    x: Math.floor(Math.random()* (canvas.width/box)) * box,
    y: Math.floor(Math.random()* (canvas.height/box)) * box
  };
}

// Rounded rectangle helper for smooth snake body segments
function roundRect(ctx, x, y, width, height, radius, fill, stroke) {
  if (typeof stroke === 'undefined') {
    stroke = true;
  }
  if (typeof radius === 'undefined') {
    radius = 5;
  }
  ctx.beginPath();
  ctx.moveTo(x + radius, y);
  ctx.lineTo(x + width - radius, y);
  ctx.quadraticCurveTo(x + width, y, x + width, y + radius);
  ctx.lineTo(x + width, y + height - radius);
  ctx.quadraticCurveTo(x + width, y + height, x + width - radius, y + height);
  ctx.lineTo(x + radius, y + height);
  ctx.quadraticCurveTo(x, y + height, x, y + height - radius);
  ctx.lineTo(x, y + radius);
  ctx.quadraticCurveTo(x, y, x + radius, y);
  ctx.closePath();
  if (fill) {
    ctx.fill();
  }
  if (stroke) {
    ctx.stroke();
  }
}

// Draw the snake's head with glowing eyes
function drawSnakeHead(x, y) {
  // Base gradient fill for head
  let gradient = ctx.createLinearGradient(x, y, x + box, y + box);
  gradient.addColorStop(0, "#ff00ff");
  gradient.addColorStop(1, "#800080");
  ctx.fillStyle = gradient;
  ctx.strokeStyle = "#ff00ff";
  ctx.lineWidth = 2;
  roundRect(ctx, x + 2, y + 2, box - 4, box - 4, 6, true, true);

  // Draw eyes
  ctx.fillStyle = "#fff";
  ctx.shadowColor = "#ff00ff";
  ctx.shadowBlur = 8;

  // Left eye
  ctx.beginPath();
  ctx.ellipse(x + box*0.3, y + box*0.35, 4, 6, 0, 0, 2 * Math.PI);
  ctx.fill();

  // Right eye
  ctx.beginPath();
  ctx.ellipse(x + box*0.7, y + box*0.35, 4, 6, 0, 0, 2 * Math.PI);
  ctx.fill();

  ctx.shadowBlur = 0; // reset shadow
}

// Draw body segment with gradient and glow
function drawSnakeBodySegment(x, y) {
  let gradient = ctx.createLinearGradient(x, y, x + box, y + box);
  gradient.addColorStop(0, "#3300cc");
  gradient.addColorStop(1, "#0000ff");

  ctx.fillStyle = gradient;
  ctx.strokeStyle = "#4400ff";
  ctx.lineWidth = 2;
  roundRect(ctx, x + 3, y + 3, box - 6, box - 6, 5, true, true);
}

function drawSnake() {
  // Clear canvas
  ctx.fillStyle = "black";
  ctx.fillRect(0, 0, canvas.width, canvas.height);

  // Draw glowing food with radial gradient
  let gradientFood = ctx.createRadialGradient(
    food.x + box/2, food.y + box/2, box/4,
    food.x + box/2, food.y + box/2, box
  );
  gradientFood.addColorStop(0, "#ff00ff");
  gradientFood.addColorStop(1, "transparent");
  ctx.fillStyle = gradientFood;
  ctx.fillRect(food.x, food.y, box, box);

  // Solid center of food
  ctx.fillStyle = "#ff00ff";
  ctx.fillRect(food.x + 4, food.y + 4, box - 8, box - 8);

  // Draw snake segments
  for (let i = 0; i < snake.length; i++) {
    let segment = snake[i];
    let x = segment.x;
    let y = segment.y;

    if (i === 0) {
      drawSnakeHead(x, y);
    } else {
      drawSnakeBodySegment(x, y);
    }
  }

  document.getElementById("snakeScore").textContent = "Score: " + score;
}

function game() {
  if(pausedForMiniGame) return; // pause snake if in mini-game
  let headX=snake[0].x, headY=snake[0].y;
  if(direction==="LEFT") headX-=box;
  if(direction==="RIGHT") headX+=box;
  if(direction==="UP") headY-=box;
  if(direction==="DOWN") headY+=box;
  if(headX>=canvas.width) headX=0; if(headX<0) headX=canvas.width-box;
  if(headY>=canvas.height) headY=0; if(headY<0) headY=canvas.height-box;
  for(let i=0;i<snake.length;i++){ if(snake[i].x===headX && snake[i].y===headY){resetSnake(); return;} }
  let newHead={x:headX,y:headY};
  if(headX===food.x && headY===food.y){
    score++;
    pausedForMiniGame=true;
    openRPS(); // Pause and open RPS
  } else { snake.pop(); }
  snake.unshift(newHead);
  drawSnake();
}
window.addEventListener("keydown",e=>{
  if(e.key==="ArrowLeft"&&direction!=="RIGHT")direction="LEFT";
  if(e.key==="ArrowRight"&&direction!=="LEFT")direction="RIGHT";
  if(e.key==="ArrowUp"&&direction!=="DOWN")direction="UP";
  if(e.key==="ArrowDown"&&direction!=="UP")direction="DOWN";
});
resetSnake();

/* ---------------- RPS ---------------- */
const rpsPopup=document.getElementById("rpsPopup");
const rpsResult=document.getElementById("rpsResult");
function openRPS(){ rpsPopup.style.display="block"; }
function playRPS(player){
  const choices=["rock","paper","scissors","lizard","spock"];
  const comp=choices[Math.floor(Math.random()*choices.length)];
  let winner="draw";
  const beats={
    rock:["scissors","lizard"],paper:["rock","spock"],
    scissors:["paper","lizard"],lizard:["spock","paper"],spock:["scissors","rock"]
  };
  if(beats[player].includes(comp)) winner="player";
  else if(beats[comp].includes(player)) winner="computer";
  rpsResult.textContent=`You: ${player} | Computer: ${comp} => ${winner}`;
  if(winner==="player"||winner==="draw"){ // success ‚Üí play TicTacToe
    rpsPopup.style.display="none";
    openTTT();
  } else {
    resetSnake(); // lose ‚Üí snake restarts
    rpsPopup.style.display="none";
    pausedForMiniGame=false;
  }
}

/* ---------------- Tic Tac Toe ---------------- */
const tttPopup=document.getElementById("tttPopup");
const tttBoard=document.getElementById("ticTacToeBoard");
const tttResult=document.getElementById("tttResult");
let tttCells;
function openTTT(){
  tttPopup.style.display="block";
  tttBoard.innerHTML="";
  tttResult.textContent="";
  for(let i=0;i<9;i++){
    let btn=document.createElement("button");
    btn.addEventListener("click",()=>makeMove(i,btn));
    tttBoard.appendChild(btn);
  }
  tttCells=Array(9).fill("");
}
function makeMove(i,btn){
  if(tttCells[i]!=="")return;
  tttCells[i]="X"; btn.textContent="X";
  if(checkWin("X")){ endTTT("You Win!"); return; }
  if(tttCells.every(c=>c!=="")){ endTTT("Draw!"); return; }
  compMove();
}
function compMove(){
  let empty=tttCells.map((c,idx)=>c===""?idx:null).filter(c=>c!==null);
  let choice=empty[Math.floor(Math.random()*empty.length)];
  tttCells[choice]="O";
  tttBoard.children[choice].textContent="O";
  if(checkWin("O")){ endTTT("Computer Wins!"); }
}
function checkWin(sym){
  const wins=[[0,1,2],[3,4,5],[6,7,8],[0,3,6],[1,4,7],[2,5,8],[0,4,8],[2,4,6]];
  return wins.some(w=>w.every(i=>tttCells[i]===sym));
}
function endTTT(msg){
  tttResult.textContent=msg;
  setTimeout(()=>{
    tttPopup.style.display="none";
    pausedForMiniGame=false; // Resume snake
    createFood(); // new food after
  },1500);
}
</script>
</body>
</html>

